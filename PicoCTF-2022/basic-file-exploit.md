# basic-file-exploit
Category: Binary Exploitation
Points: 100
Author: Kaden Wu
## Problem Description
The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!Connect to the program with netcat:`$ nc saturn.picoctf.net 65317`The program's source code with the flag redacted can be downloaded  [here](https://artifacts.picoctf.net/c/139/program-redacted.c).
## Writeup
When we look at the C code that we get, we can see this:
```cpp
static void data_read() {
  char entry[4];
  long entry_number;
  char output[100];
  int r;

  memset(output, '\0', 100);
  
  printf("Please enter the entry number of your data:\n");
  r = tgetinput(entry, 4);
  // Timeout on user input
  if(r == -3)
  {
    printf("Goodbye!\n");
    exit(0);
  }
  
  if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }

  entry_number--;
  strncpy(output, data[entry_number], input_lengths[entry_number]);
  puts(output);
}
```
Specifically, this portion:
```cpp
 if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }
```
As we can see, the program will print it if we put 0 when we are asked what data to read. We do that, and we get our flag!
`picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_1B9F5942}`
